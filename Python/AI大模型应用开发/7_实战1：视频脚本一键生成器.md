---
title: å®æˆ˜1ï¼šè§†é¢‘è„šæœ¬ä¸€é”®ç”Ÿæˆå™¨
tags:
  - Python
categories:
  - Python
---



## ä¸€ã€é¡¹ç›®ä»‹ç»

### 1ã€æ ¸å¿ƒåŠŸèƒ½

- å®ç°è§†é¢‘è„šæœ¬çš„ä¸€é”®ç”Ÿæˆï¼Œç»“åˆç”¨æˆ·éœ€æ±‚ä¸å¤–éƒ¨ä¿¡æ¯ï¼Œæå‡è„šæœ¬çš„å‡†ç¡®æ€§å’Œå®æ—¶æ€§ã€‚

### 2ã€ç•Œé¢ä¸ç”¨æˆ·è¾“å…¥

1. **ä¾§è¾¹æ **
   - æ”¯æŒç”¨æˆ·è¾“å…¥ API å¯†é’¥ï¼ˆå¦‚ OpenAI API å¯†é’¥ï¼‰ï¼Œé¿å…ä»…æ¶ˆè€—å¼€å‘è€…çš„ tokenã€‚
   - é™„å®˜æ–¹ç½‘ç«™é“¾æ¥ï¼Œæ–¹ä¾¿ç”¨æˆ·äº†è§£å¦‚ä½•è·å– API å¯†é’¥ã€‚
   - å¯çµæ´»é€‚é…å…¶ä»–å¤§æ¨¡å‹ï¼šè‹¥ä½¿ç”¨æ–‡å¿ƒä¸€è¨€ç­‰ï¼Œå¯æ›¿æ¢è¾“å…¥æç¤ºè¯­åŠåç«¯æ¨¡å‹ï¼›è‡ªç”¨åœºæ™¯ä¸‹ï¼Œå¯ç§»é™¤è¾“å…¥æ¡†ï¼Œç›´æ¥åœ¨ä»£ç ä¸­åµŒå…¥å¯†é’¥ã€‚
2. **ä¸»é¡µé¢**
   - ç”¨æˆ·éœ€è¾“å…¥ï¼šè§†é¢‘ä¸»é¢˜ï¼ˆä»»æ„ä¸»é¢˜ï¼‰ã€ç”Ÿæˆè„šæœ¬çš„å¤§è‡´æ—¶é•¿ï¼ˆä»»æ„æ•°å­—ï¼‰ã€åˆ›é€ åŠ›å‚æ•°ï¼ˆèŒƒå›´ 0-1ï¼Œå¯¹åº” AI çš„ Temperature å‚æ•°ï¼šå€¼è¶Šä½ï¼Œéšæœºæ€§å’Œåˆ›é€ æ€§è¶Šå¼±ï¼›å€¼è¶Šé«˜ï¼Œéšæœºæ€§å’Œåˆ›é€ æ€§è¶Šå¼ºï¼Œå¯èƒ½å‡ºç°æ„å¤–å›ç­”ï¼‰ã€‚

### 3ã€ç”Ÿæˆæµç¨‹

1. **ç‚¹å‡» â€œç”Ÿæˆè„šæœ¬â€ å**
   - å…ˆåˆ¤æ–­ç”¨æˆ·æ˜¯å¦æä¾› API å¯†é’¥ï¼Œè‹¥å·²æä¾›ï¼Œæ˜¾ç¤ºåŠ è½½ç»„ä»¶ï¼Œæç¤ºç”¨æˆ· AI æ­£åœ¨ç”Ÿæˆã€‚
   - ç”Ÿæˆå®Œæˆåï¼Œå±•ç¤ºè§†é¢‘æ ‡é¢˜ã€è„šæœ¬å†…å®¹ï¼Œä»¥åŠç»´åŸºç™¾ç§‘æœç´¢ç»“æœï¼ˆç”¨æˆ·å¯ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…ï¼‰ã€‚
2. **èƒŒåçš„å¢å¼ºæœºåˆ¶**
   - è°ƒç”¨ç»´åŸºç™¾ç§‘ APIï¼šåœ¨å‘ AI æ¨¡å‹å‘é€è¯·æ±‚å‰ï¼Œå…ˆé€šè¿‡ç»´åŸºç™¾ç§‘ API è·å–ç›¸å…³å†…å®¹ï¼Œä¸ç”¨æˆ·éœ€æ±‚ç»“åˆåä¸€å¹¶ä¼ ç»™ AIã€‚
   - ç›®çš„ï¼šå¼¥è¡¥ AI æ¨¡å‹çŸ¥è¯†å—è®­ç»ƒæ—¥æœŸé™åˆ¶çš„é—®é¢˜ï¼ˆä¾‹å¦‚ 2024 å¹´ 2 æœˆå…¬å¼€çš„ SORA æ¨¡å‹ï¼Œæ­¤å‰è®­ç»ƒçš„æ¨¡å‹å‡ä¸äº†è§£è¯¥å†…å®¹ï¼‰ï¼Œç¡®ä¿ AI è·å¾—çœŸå®ã€å®æ—¶çš„è¡¥å……ä¿¡æ¯ï¼Œé¿å…èƒ¡ç¼–ä¹±é€ ã€‚

## äºŒã€åˆ›å»ºé¡¹ç›®åŠå®‰è£…ä¾èµ–é¡¹

### 1ã€åˆ›å»ºé¡¹ç›®æ–‡ä»¶å¤¹

- æ–°å»ºç‹¬ç«‹æ–‡ä»¶å¤¹ï¼ˆå¦‚å‘½åä¸º`video-script-generator`ï¼‰ï¼Œç”¨äºå­˜æ”¾ç½‘ç«™ç›¸å…³çš„æ‰€æœ‰ä»£ç ã€å›¾ç‰‡ç­‰èµ„æºï¼Œå®ç°æ–‡ä»¶ç®¡ç†çš„è§„èŒƒåŒ–ã€‚

### 2ã€é…ç½®venvè™šæ‹Ÿç¯å¢ƒ

1. **åˆ›å»ºæ–¹å¼**ï¼š
   - PyCharm åˆ›å»ºé¡¹ç›®æ—¶é»˜è®¤ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒï¼›å…¶ä»–ç¼–è¾‘å™¨å¯æœç´¢å¯¹åº”æ–¹æ³•ï¼ˆå¦‚`python -m venv è™šæ‹Ÿç¯å¢ƒå`ï¼‰ã€‚
2. **æ ¸å¿ƒä½œç”¨**ï¼š
   - **ç¯å¢ƒéš”ç¦»**ï¼šä¸ºä¸åŒé¡¹ç›®æä¾›ç‹¬ç«‹çš„å¼€å‘ç¯å¢ƒï¼Œæ”¯æŒä½¿ç”¨ä¸åŒç‰ˆæœ¬çš„ Python è§£é‡Šå™¨ï¼ˆå¦‚é¡¹ç›® 1 ç”¨ 3.8ï¼Œé¡¹ç›® 2 ç”¨ 3.10ï¼‰ã€‚
   - **ä¾èµ–ç®¡ç†**ï¼šé¿å…ä¸åŒé¡¹ç›®çš„ä¾èµ–å†²çªï¼ˆä¾‹å¦‚é¡¹ç›® 1 éœ€åº“ A 1.0 ç‰ˆæœ¬ï¼Œé¡¹ç›® 2 éœ€åº“ A 1.1 ç‰ˆæœ¬æ—¶ï¼Œä¸ä¼šç›¸äº’å½±å“ï¼‰ã€‚
3. **æ³¨æ„äº‹é¡¹**ï¼š
   - ç¼ºç‚¹ï¼šæ¯ä¸ªè™šæ‹Ÿç¯å¢ƒä¼šå¤åˆ¶è§£é‡Šå™¨å’Œåº“ï¼Œå ç”¨è¾ƒå¤šå­˜å‚¨ç©ºé—´ã€‚
   - ä¾‹å¤–ï¼šä¸´æ—¶ç»ƒä¹ çš„å°é¡¹ç›®å¯çœç•¥è™šæ‹Ÿç¯å¢ƒã€‚

### 3ã€å¤„ç†ä¾èµ–æ–‡ä»¶ï¼ˆrequirements.txtï¼‰

1. **æ–‡ä»¶ä½œç”¨**ï¼š

   - å­˜å‚¨é¡¹ç›®è¿è¡Œæ‰€éœ€çš„æ‰€æœ‰ä¾èµ–åº“åŠ**ç²¾å‡†ç‰ˆæœ¬å·**ï¼Œç¡®ä¿é¡¹ç›®åœ¨ä¸åŒç¯å¢ƒä¸­è¿è¡Œçš„ä¸€è‡´æ€§ï¼ˆé¿å…å› ç‰ˆæœ¬å·®å¼‚å¯¼è‡´ä»£ç æŠ¥é”™ï¼‰ã€‚

2. **ä½¿ç”¨æ­¥éª¤**ï¼š

   - ä»é¡¹ç›®æ–‡ä»¶å¤¹æ–°å»º`requirements.txt`ã€‚

     ~~~txt
     aiofiles==23.2.1
     aiohttp==3.9.1
     aiosignal==1.3.1
     altair==5.2.0
     annotated-types==0.6.0
     anyio==3.7.1
     async-timeout==4.0.3
     attrs==23.1.0
     beautifulsoup4==4.12.2
     blinker==1.7.0
     Brotli==1.1.0
     cachetools==5.3.2
     certifi==2023.11.17
     charset-normalizer==3.3.2
     click==8.1.7
     dataclasses-json==0.6.3
     distro==1.8.0
     duckduckgo-search==3.9.9
     exceptiongroup==1.2.0
     frozenlist==1.4.0
     gitdb==4.0.11
     GitPython==3.1.40
     greenlet==3.0.1
     h11==0.14.0
     h2==4.1.0
     hpack==4.0.0
     httpcore==1.0.2
     httpx==0.25.2
     hyperframe==6.0.1
     idna==3.6
     importlib-metadata==6.8.0
     Jinja2==3.1.2
     jsonpatch==1.33
     jsonpointer==2.4
     jsonschema==4.20.0
     jsonschema-specifications==2023.11.2
     langchain==0.1.9
     langchain-community==0.0.24
     langchain-core==0.1.26
     langchain-openai==0.0.7
     langsmith==0.1.6
     lxml==4.9.3
     markdown-it-py==3.0.0
     MarkupSafe==2.1.3
     marshmallow==3.20.1
     mdurl==0.1.2
     multidict==6.0.4
     mypy-extensions==1.0.0
     numpy==1.26.2
     openai==1.12.0
     orjson==3.9.15
     packaging==23.2
     pandas==2.1.3
     Pillow==10.1.0
     protobuf==4.25.1
     pyarrow==14.0.1
     pydantic==2.5.2
     pydantic_core==2.14.5
     pydeck==0.8.1b0
     Pygments==2.17.2
     python-dateutil==2.8.2
     pytz==2023.3.post1
     PyYAML==6.0.1
     referencing==0.31.1
     regex==2023.12.25
     requests==2.31.0
     rich==13.7.0
     rpds-py==0.13.2
     six==1.16.0
     smmap==5.0.1
     sniffio==1.3.0
     socksio==1.0.0
     soupsieve==2.5
     SQLAlchemy==2.0.23
     streamlit==1.31.1
     tenacity==8.2.3
     tiktoken==0.6.0
     toml==0.10.2
     toolz==0.12.0
     tornado==6.4
     tqdm==4.66.1
     typing-inspect==0.9.0
     typing_extensions==4.8.0
     tzdata==2023.3
     tzlocal==5.2
     urllib3==2.1.0
     validators==0.22.0
     wikipedia==1.4.0
     yarl==1.9.3
     zipp==3.17.0
     ~~~

   - åœ¨ç»ˆç«¯è¿è¡Œå‘½ä»¤å®‰è£…ä¾èµ–ï¼š`pip install -r requirements.txt`ï¼Œå³å¯è‡ªåŠ¨å®‰è£…æ‰€æœ‰æŒ‡å®šç‰ˆæœ¬çš„åº“ã€‚

3. **æ–‡ä»¶ç”Ÿæˆæ–¹å¼**ï¼š

   - è‹¥éœ€è‡ªå·±ç”Ÿæˆï¼Œåœ¨è™šæ‹Ÿç¯å¢ƒä¸­è¿è¡Œå‘½ä»¤ï¼š`pip freeze > requirements.txt`ï¼Œä¼šå°†å½“å‰ç¯å¢ƒä¸­æ‰€æœ‰å®‰è£…åŒ…åŠç‰ˆæœ¬å·å†™å…¥æ–‡ä»¶ã€‚

## ä¸‰ã€åˆ›å»ºAIè¯·æ±‚

### 1ã€æ–‡ä»¶ä¸å‡½æ•°å‡†å¤‡

1. æ–°å»ºä»£ç æ–‡ä»¶ï¼ˆå¦‚å‘½åä¸º`utils.py`ï¼‰ï¼Œç”¨äºå°è£…ä¸ AI å¤§æ¨¡å‹äº¤äº’çš„ä»£ç ã€‚
2. å®šä¹‰`generate_script`å‡½æ•°ï¼Œæ¥æ”¶å‚æ•°ï¼šè§†é¢‘ä¸»é¢˜ï¼ˆ`subject`ï¼‰ã€æ—¶é•¿ï¼ˆ`duration`ï¼‰ã€åˆ›é€ æ€§ï¼ˆ`creativity`ï¼‰ã€API å¯†é’¥ï¼ˆ`api_key`ï¼‰ï¼Œç”¨äºç”Ÿæˆè§†é¢‘æ ‡é¢˜å’Œè„šæœ¬ã€‚

### 2ã€æç¤ºæ¨¡æ¿å®šä¹‰

ä»`LangChain`å¯¼å…¥`ChatPromptTemplate`ï¼Œåˆ†åˆ«å®šä¹‰ç”Ÿæˆæ ‡é¢˜å’Œè„šæœ¬çš„æç¤ºæ¨¡æ¿ï¼š

- **æ ‡é¢˜æ¨¡æ¿ï¼ˆ`title_template`ï¼‰**ï¼šé€šè¿‡`from_messages`æ–¹æ³•æ¥æ”¶å«å˜é‡ï¼ˆè§†é¢‘ä¸»é¢˜`subject`ï¼‰çš„æ¶ˆæ¯åˆ—è¡¨ï¼Œç”¨äºç”Ÿæˆè§†é¢‘æ ‡é¢˜ã€‚
- **è„šæœ¬æ¨¡æ¿ï¼ˆ`script_template`ï¼‰**ï¼šåŒæ ·ç”¨`from_messages`æ–¹æ³•ï¼Œæ¶ˆæ¯åˆ—è¡¨åŒ…å«å¤šä¸ªå˜é‡ï¼ˆæ ‡é¢˜`title`ã€æ—¶é•¿`duration`ã€ç»´åŸºç™¾ç§‘æœç´¢ç»“æœ`wikipedia_search`ï¼‰ï¼Œç”¨äºç”Ÿæˆè„šæœ¬å†…å®¹ã€‚

### 3ã€æ¨¡å‹é…ç½®

ä»`LangChain.OpenAI`å¯¼å…¥èŠå¤©æ¨¡å‹ï¼Œé…ç½®`ChatOpenAI`ï¼š

- ä¼ å…¥ç”¨æˆ·æä¾›çš„`api_key`ã€‚
- å°†`creativity`å‚æ•°å€¼èµ‹ç»™æ¨¡å‹çš„`temperature`ï¼ˆæ§åˆ¶å†…å®¹åˆ›é€ æ€§ï¼Œå€¼è¶Šé«˜åˆ›é€ æ€§è¶Šå¼ºï¼‰ã€‚
- è‹¥ä½¿ç”¨è¯¾ç¨‹æä¾›çš„ API å¯†é’¥ï¼Œå¯è¡¥å……`openai_api_base`å‚æ•°ã€‚

### 4ã€é“¾å¼è°ƒç”¨ä¸ç»“æœè·å–

1. **ç”Ÿæˆæ ‡é¢˜**ï¼š
   - ç»„è£…æ ‡é¢˜ç”Ÿæˆé“¾ï¼ˆ`TitleChain`ï¼‰ï¼Œå°†`TitleTemplate`ä¸æ¨¡å‹ç»“åˆã€‚
   - è°ƒç”¨`TitleChain.invoke`ï¼Œä¼ å…¥å«`subject`ï¼ˆç”¨æˆ·æä¾›çš„è§†é¢‘ä¸»é¢˜ï¼‰çš„å­—å…¸ï¼Œé€šè¿‡è¿”å›æ¶ˆæ¯çš„`content`å±æ€§è·å–æ ‡é¢˜ï¼Œå­˜å…¥`title`å˜é‡ã€‚
2. **è·å–ç»´åŸºç™¾ç§‘æœç´¢ç»“æœ**ï¼š
   - ä»`LangChain.Community.Utilities`å¯¼å…¥`WikipediaAPIWrapper`ï¼Œåˆ›å»ºå®ä¾‹å¹¶è®¾ç½®`lang="zh"`ï¼ˆæŒ‡å®šä¸­æ–‡æœç´¢ï¼Œä¹Ÿå¯é»˜è®¤è‹±æ–‡ï¼‰ã€‚
   - è°ƒç”¨å®ä¾‹çš„`run`æ–¹æ³•ï¼Œä¼ å…¥è§†é¢‘ä¸»é¢˜ä½œä¸ºæœç´¢è¯ï¼Œè·å–æœç´¢ç»“æœæ‘˜è¦ã€‚
3. **ç”Ÿæˆè„šæœ¬**ï¼š
   - ç»„è£…è„šæœ¬ç”Ÿæˆé“¾ï¼ˆ`ScriptChain`ï¼‰ï¼Œå°†`ScriptTemplate`ä¸æ¨¡å‹ç»“åˆã€‚
   - è°ƒç”¨`ScriptChain.invoke`ï¼Œä¼ å…¥å«`title`ï¼ˆç”Ÿæˆçš„æ ‡é¢˜ï¼‰ã€`duration`ï¼ˆç”¨æˆ·æä¾›çš„æ—¶é•¿ï¼‰ã€`wikipedia_search`ï¼ˆç»´åŸºç™¾ç§‘æœç´¢ç»“æœï¼‰çš„å­—å…¸ï¼Œé€šè¿‡è¿”å›æ¶ˆæ¯çš„`content`å±æ€§è·å–è„šæœ¬å†…å®¹ã€‚

### 5ã€ç»“æœè¿”å›ä¸æµ‹è¯•

- å‡½æ•°æœ€åè¿”å›è§†é¢‘æ ‡é¢˜ã€è„šæœ¬å†…å®¹ã€ç»´åŸºç™¾ç§‘æœç´¢ç»“æœã€‚
- æµ‹è¯•æ—¶è°ƒç”¨`GenerateScript`ï¼Œä¼ å…¥æµ‹è¯•ç”¨çš„è§†é¢‘ä¸»é¢˜ã€æ—¶é•¿ã€åˆ›é€ æ€§å‚æ•°åŠ API å¯†é’¥ï¼Œæ‰“å°ç»“æœä»¥éªŒè¯é€»è¾‘ï¼ˆè¿è¡Œä¸­è‹¥å‡ºç°ç»´åŸºç™¾ç§‘åº“çš„è­¦å‘Šï¼Œä¸€èˆ¬å¯å¿½ç•¥ï¼Œé‡ç‚¹å…³æ³¨é”™è¯¯`error`ï¼‰ã€‚

### 6ã€å®Œæ•´ä»£ç 

~~~python
from langchain.prompts import ChatPromptTemplate
from langchain_openai import ChatOpenAI
from langchain_community.utilities import WikipediaAPIWrapper

# import os

def generate_script(subject, video_length, creativity, api_key):
    title_template = ChatPromptTemplate.from_messages(
        [
            ("human", "è¯·ä¸º'{subject}'è¿™ä¸ªä¸»é¢˜çš„è§†é¢‘æƒ³ä¸€ä¸ªå¸å¼•äººçš„æ ‡é¢˜")
        ]
    )
    script_template = ChatPromptTemplate.from_messages(
        [
            ("human",
             """ä½ æ˜¯ä¸€ä½çŸ­è§†é¢‘é¢‘é“çš„åšä¸»ã€‚æ ¹æ®ä»¥ä¸‹æ ‡é¢˜å’Œç›¸å…³ä¿¡æ¯ï¼Œä¸ºçŸ­è§†é¢‘é¢‘é“å†™ä¸€ä¸ªè§†é¢‘è„šæœ¬ã€‚
             è§†é¢‘æ ‡é¢˜ï¼š{title}ï¼Œè§†é¢‘æ—¶é•¿ï¼š{duration}åˆ†é’Ÿï¼Œç”Ÿæˆçš„è„šæœ¬çš„é•¿åº¦å°½é‡éµå¾ªè§†é¢‘æ—¶é•¿çš„è¦æ±‚ã€‚
             è¦æ±‚å¼€å¤´æŠ“ä½é™çƒï¼Œä¸­é—´æä¾›å¹²è´§å†…å®¹ï¼Œç»“å°¾æœ‰æƒŠå–œï¼Œè„šæœ¬æ ¼å¼ä¹Ÿè¯·æŒ‰ç…§ã€å¼€å¤´ã€ä¸­é—´ï¼Œç»“å°¾ã€‘åˆ†éš”ã€‚
             æ•´ä½“å†…å®¹çš„è¡¨è¾¾æ–¹å¼è¦å°½é‡è½»æ¾æœ‰è¶£ï¼Œå¸å¼•å¹´è½»äººã€‚
             è„šæœ¬å†…å®¹å¯ä»¥ç»“åˆä»¥ä¸‹ç»´åŸºç™¾ç§‘æœç´¢å‡ºçš„ä¿¡æ¯ï¼Œä½†ä»…ä½œä¸ºå‚è€ƒï¼Œåªç»“åˆç›¸å…³çš„å³å¯ï¼Œå¯¹ä¸ç›¸å…³çš„è¿›è¡Œå¿½ç•¥ï¼š
             ```{wikipedia_search}```""")
        ]
    )

    model = ChatOpenAI(openai_api_key=api_key, temperature=creativity)

    title_chain = title_template | model
    script_chain = script_template | model

    title = title_chain.invoke({"subject": subject}).content

    search = WikipediaAPIWrapper(lang="zh")
    search_result = search.run(subject)

    script = script_chain.invoke({"title": title, "duration": video_length,
                                  "wikipedia_search": search_result}).content

    return search_result, title, script

# print(generate_script("soraæ¨¡å‹", 1, 0.7, os.getenv("OPENAI_API_KEY")))
~~~



## å››ã€åˆ›å»ºç½‘ç«™é¡µé¢

ä½¿ç”¨ Streamlit å¼€å‘è§†é¢‘è„šæœ¬ç”Ÿæˆå™¨å‰ç«¯

### 1ã€å‰æœŸå‡†å¤‡

1. **æ–‡ä»¶ä¸ä¾èµ–**
   - åˆ é™¤ / æ³¨é‡Šä¸Šä¸€èŠ‚ä¸­æµ‹è¯•`generate_script`çš„ä»£ç ã€‚
   - æ–°å»ºä»£ç æ–‡ä»¶`main.py`ï¼ˆä½œä¸ºç½‘ç«™ä¸»é¡µï¼‰ï¼Œå¯¼å…¥`streamlit`åº“å’Œä¸Šä¸€èŠ‚åˆ›å»ºçš„`generate_script`å‡½æ•°ï¼ˆæ— éœ€å†å¯¼å…¥ LangChain ç›¸å…³åº“ï¼‰ã€‚
2. **è¿è¡Œç½‘é¡µ**
   - ç»™ç½‘é¡µæ·»åŠ æ ‡é¢˜ï¼ˆå¦‚ â€œè§†é¢‘è„šæœ¬ç”Ÿæˆå™¨â€ï¼‰ï¼Œé€šè¿‡å‘½ä»¤`streamlit run æ–‡ä»¶å.py`è¿è¡Œç½‘é¡µï¼Œå®æ—¶æŸ¥çœ‹æ•ˆæœã€‚

### 2ã€ä¾§è¾¹æ è®¾è®¡ï¼ˆç”¨æˆ· API å¯†é’¥ç›¸å…³ï¼‰

é€šè¿‡`with streamlit.sidebar:`åˆ›å»ºä¾§è¾¹æ ï¼Œç¼©è¿›å†…å®¹å‡æ˜¾ç¤ºåœ¨ä¾§è¾¹æ ä¸­ï¼š

- **API å¯†é’¥è¾“å…¥æ¡†**ï¼šä½¿ç”¨`st.text_input`ï¼Œæç¤ºæ–‡å­—ä¸º â€œè¯·è¾“å…¥ OpenAI API å¯†é’¥â€ï¼Œè®¾ç½®`type="password"`éšè—è¾“å…¥å†…å®¹ï¼Œç”¨å˜é‡ä¿å­˜è¾“å…¥çš„å¯†é’¥ï¼ˆå¦‚`api_key`ï¼‰ã€‚
- **API å¯†é’¥è·å–é“¾æ¥**ï¼šç”¨`st.markdown`æ·»åŠ  Markdown æ ¼å¼é“¾æ¥ï¼ˆè¯­æ³•ï¼š`[é“¾æ¥æ ‡ç­¾](é“¾æ¥åœ°å€)`ï¼‰ï¼Œç›´è¾¾ OpenAI å®˜æ–¹å¯†é’¥åˆ›å»ºé¡µé¢ï¼Œæ–¹ä¾¿ç”¨æˆ·è·å–å¯†é’¥ã€‚

### 3ã€ä¸»é¡µé¢ç»„ä»¶ï¼ˆç”¨æˆ·è¾“å…¥ç›¸å…³ï¼‰

ä¸»é¡µé¢ç»„ä»¶æ— éœ€ç¼©è¿›ï¼ˆé¿å…å½’å…¥ä¾§è¾¹æ ï¼‰ï¼ŒåŒ…æ‹¬ï¼š

1. **è§†é¢‘ä¸»é¢˜è¾“å…¥**ï¼š`st.text_input`ï¼Œæç¤ºæ–‡å­—ä¸º â€œè¯·è¾“å…¥è§†é¢‘çš„ä¸»é¢˜â€ï¼Œç»“æœä¿å­˜åˆ°`subject`å˜é‡ã€‚
2. **è§†é¢‘æ—¶é•¿è¾“å…¥**ï¼š`st.number_input`ï¼Œæç¤ºæ–‡å­—ä¸º â€œè¯·è¾“å…¥è§†é¢‘çš„å¤§è‡´æ—¶é•¿â€ï¼Œè®¾ç½®æœ€å°å€¼`0.1`ã€æ­¥é•¿`0.1`ï¼ˆæ¯æ¬¡å¢å‡ 0.1ï¼‰ï¼Œç»“æœä¿å­˜åˆ°`video_length`å˜é‡ã€‚
3. **åˆ›é€ åŠ›è°ƒèŠ‚æ»‘å—**ï¼š`st.slider`ï¼Œæ§åˆ¶ AI çš„`temperature`å‚æ•°ï¼Œè®¾ç½®æœ€å°å€¼`0.0`ã€æœ€å¤§å€¼`1.0`ï¼ˆé¿å…è¿‡é«˜å¯¼è‡´å†…å®¹æ··ä¹±ï¼‰ã€é»˜è®¤å€¼`0.2`ã€æ­¥é•¿`0.1`ï¼Œç»“æœä¿å­˜åˆ°`creativity`å˜é‡ã€‚
4. **ç”ŸæˆæŒ‰é’®**ï¼š`st.button`ï¼Œæ–‡å­—ä¸º â€œç”Ÿæˆè„šæœ¬â€ï¼Œè¿”å›å¸ƒå°”å€¼ï¼ˆç‚¹å‡»åä¸º`True`ï¼‰ï¼Œç”¨äºè§¦å‘åç»­é€»è¾‘ã€‚

### 4ã€ç”¨æˆ·äº¤äº’é€»è¾‘ï¼ˆç‚¹å‡»æŒ‰é’®åå¤„ç†ï¼‰

1. **è¾“å…¥éªŒè¯**ï¼š
   - è‹¥ç”¨æˆ·ç‚¹å‡»æŒ‰é’®ä½†æœªæä¾›`api_key`ï¼šç”¨`st.info`æç¤º â€œè¯·è¾“å…¥ API å¯†é’¥â€ï¼Œè°ƒç”¨`st.stop()`ç»ˆæ­¢åç»­ä»£ç ã€‚
   - è‹¥æœªæä¾›`subject`ï¼šæç¤º â€œè¯·è¾“å…¥è§†é¢‘çš„ä¸»é¢˜â€ å¹¶ç»ˆæ­¢ã€‚
   - è‹¥`video_length`å°äº 0.1ï¼šæç¤º â€œè§†é¢‘æ—¶é•¿éœ€ä¸å°äº 0.1â€ å¹¶ç»ˆæ­¢ã€‚
2. **è°ƒç”¨åç«¯å‡½æ•°ä¸åŠ è½½çŠ¶æ€**ï¼š
   - éªŒè¯é€šè¿‡åï¼Œç”¨`with st.spinner("AIæ­£åœ¨ç”Ÿæˆè„šæœ¬..."):`åŒ…è£¹`generate_script`è°ƒç”¨ï¼Œæ˜¾ç¤ºåŠ è½½åŠ¨ç”»ï¼ˆåŠ¨ç”»æŒç»­è‡³å‡½æ•°æ‰§è¡Œå®Œæ¯•ï¼‰ã€‚
   - è°ƒç”¨`generate_script(subject, video_length, creativity, api_key)`ï¼Œè·å–è¿”å›ç»“æœï¼šç»´åŸºç™¾ç§‘æœç´¢ç»“æœã€è§†é¢‘æ ‡é¢˜ã€è„šæœ¬å†…å®¹ã€‚
3. **ç»“æœå±•ç¤º**ï¼š
   - ç”¨`st.success("è§†é¢‘è„šæœ¬ç”ŸæˆæˆåŠŸï¼")`æç¤ºæˆåŠŸã€‚
   - å±•ç¤ºæ ‡é¢˜ï¼š`st.subheader("è§†é¢‘æ ‡é¢˜")` + ç”Ÿæˆçš„æ ‡é¢˜å†…å®¹ã€‚
   - å±•ç¤ºè„šæœ¬ï¼š`st.subheader("è§†é¢‘è„šæœ¬")` + ç”Ÿæˆçš„è„šæœ¬å†…å®¹ã€‚
   - å±•ç¤ºç»´åŸºç™¾ç§‘ç»“æœï¼šç”¨`st.expander("ç»´åŸºç™¾ç§‘æœç´¢ç»“æœ")`åˆ›å»ºæŠ˜å ç»„ä»¶ï¼Œå†…å®¹æ”¾å…¥å…¶ä¸­ï¼ˆç”¨æˆ·å¯è‡ªä¸»å±•å¼€æŸ¥çœ‹ï¼‰ã€‚

### 5ã€å®Œæ•´ä»£ç 

~~~python
import streamlit as st
from utils import generate_script

st.title("ğŸ¬ è§†é¢‘è„šæœ¬ç”Ÿæˆå™¨")

with st.sidebar:
    openai_api_key = st.text_input("è¯·è¾“å…¥OpenAI APIå¯†é’¥ï¼š", type="password")
    st.markdown("[è·å–OpenAI APIå¯†é’¥](https://platform.openai.com/account/api-keys)")

subject = st.text_input("ğŸ’¡ è¯·è¾“å…¥è§†é¢‘çš„ä¸»é¢˜")
video_length = st.number_input("â±ï¸ è¯·è¾“å…¥è§†é¢‘çš„å¤§è‡´æ—¶é•¿ï¼ˆå•ä½ï¼šåˆ†é’Ÿï¼‰", min_value=0.1, step=0.1)
creativity = st.slider("âœ¨ è¯·è¾“å…¥è§†é¢‘è„šæœ¬çš„åˆ›é€ åŠ›ï¼ˆæ•°å­—å°è¯´æ˜æ›´ä¸¥è°¨ï¼Œæ•°å­—å¤§è¯´æ˜æ›´å¤šæ ·ï¼‰", min_value=0.0,
                       max_value=1.0, value=0.2, step=0.1)
submit = st.button("ç”Ÿæˆè„šæœ¬")

if submit and not openai_api_key:
    st.info("è¯·è¾“å…¥ä½ çš„OpenAI APIå¯†é’¥")
    st.stop()
if submit and not subject:
    st.info("è¯·è¾“å…¥è§†é¢‘çš„ä¸»é¢˜")
    st.stop()
if submit and not video_length >= 0.1:
    st.info("è§†é¢‘é•¿åº¦éœ€è¦å¤§äºæˆ–ç­‰äº0.1")
    st.stop()
if submit:
    with st.spinner("AIæ­£åœ¨æ€è€ƒä¸­ï¼Œè¯·ç¨ç­‰..."):
        search_result, title, script = generate_script(subject, video_length, creativity, openai_api_key)
    st.success("è§†é¢‘è„šæœ¬å·²ç”Ÿæˆï¼")
    st.subheader("ğŸ”¥ æ ‡é¢˜ï¼š")
    st.write(title)
    st.subheader("ğŸ“ è§†é¢‘è„šæœ¬ï¼š")
    st.write(script)
    with st.expander("ç»´åŸºç™¾ç§‘æœç´¢ç»“æœ ğŸ‘€"):
        st.info(search_result)
~~~

### 6ã€é¡µé¢æ•ˆæœå±•ç¤º

![image-20250820225827468](7_å®æˆ˜1ï¼šè§†é¢‘è„šæœ¬ä¸€é”®ç”Ÿæˆå™¨.assets/image-20250820225827468.png)

